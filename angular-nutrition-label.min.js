"use strict";!function(){angular.module("nutritionix.nutrition-label",[]).constant("nutritionLabelGlobalOptions",{}).directive("nutritionLabel",["$log","nutritionLabelGlobalOptions",function(a,t){function e(a){if(!a)return a;var t=void 0;t=a<1?2:a<10?1:0;var e=Math.pow(10,t);return Math.round(a*e)/e}return{restrict:"A",template:'\n        <div>\n          <div class="label-container"></div>\n          <div class="label-mode-switch" ng-if="!hideModeSwitcher">\n            FDA Label Style:\n            <label class="radio-inline">\n              <input type="radio" name="labelMode" ng-value="false" ng-model="vm.showLegacyVersion"> 2018 Version\n            </label>\n            <label class="radio-inline">\n              <input type="radio" name="labelMode" ng-value="true" ng-model="vm.showLegacyVersion"> Legacy Version\n            </label>\n          </div>\n        </div>\n      ',scope:{item:"=nutritionLabel",options:"=?nutritionLabelOptions",hideModeSwitcher:"=?"},link:function(a,n,l){function i(){return JSON.stringify(r())}function r(){var e=angular.extend({},t,l,a.options||{},a.item,a.vm||{});return angular.forEach(e,function(a,t){"$"===t[0]?delete e[t]:-1===t.indexOf("userFunction")&&angular.isFunction(a)&&(e[t]=a())}),e}function u(){var t=void 0,n=void 0;if(o.html(""),angular.isObject(a.item)){if((t=angular.element("<div>").attr("id","label-"+Math.random().toString(36).substring(2))).appendTo(o),"function"==typeof(n=r()).userFunctionOnQuantityChange){var l=n.userFunctionOnQuantityChange;n.userFunctionOnQuantityChange=function(){l.apply(n,arguments),a.$apply()}}n.applyMathRounding&&["valueServingWeightGrams","valueServingPerContainer","valueCalories","valueFatCalories","valueTotalFat","valueSatFat","valueTransFat","valuePolyFat","valueMonoFat","valueCholesterol","valueSodium","valuePotassium","valueTotalCarb","valueFibers","valueSugars","valueAddedSugars","valueProteins","valueVitaminA","valueVitaminC","valueVitaminD","valueCalcium","valueIron"].forEach(function(a){angular.isUndefined(n[a])||(n[a]=e(n[a]))}),t.nutritionLabel(n)}}var o=n.find(".label-container"),d=r();a.vm={showLegacyVersion:!!angular.isUndefined(d.showLegacyVersion)||!!d.showLegacyVersion},a.$watch(i,function(a,t){a!==t&&u()}),u()}}}]).filter("trackFoodToLabelData",["$log","nutritionLabelGlobalOptions",function(a,t){function e(a,t){t=t.toString();for(var e=0;e<a.length;e+=1)if(a[e].attr_id.toString()===t)return a[e].value}var n={itemName:"Item",brandName:"Nutritionix",allowFDARounding:!1,applyMathRounding:!0,valueServingUnitQuantity:1,valueServingSizeUnit:"Serving"},l=[{labelAttribute:"valueCalories",attrId:208},{labelAttribute:"valueFatCalories",attrId:204,adapter:function(a){return 9*a}},{labelAttribute:"valueTotalFat",attrId:204},{labelAttribute:"valueSatFat",attrId:606},{labelAttribute:"valueTransFat",attrId:605},{labelAttribute:"valuePolyFat",attrId:645},{labelAttribute:"valueMonoFat",attrId:646},{labelAttribute:"valueCholesterol",attrId:601},{labelAttribute:"valueSodium",attrId:307},{labelAttribute:"valuePotassium",attrId:306},{labelAttribute:"valuePotassium_2018",attrId:306,dailyValue:3500},{labelAttribute:"valueTotalCarb",attrId:205},{labelAttribute:"valueFibers",attrId:291},{labelAttribute:"valueSugars",attrId:269},{labelAttribute:"valueProteins",attrId:203},{labelAttribute:"valueVitaminA",attrId:318,dailyValue:5e3},{labelAttribute:"valueVitaminC",attrId:401,dailyValue:60},{labelAttribute:"valueVitaminD",attrId:324,dailyValue:400},{labelAttribute:"valueCalcium",attrId:324,dailyValue:1e3},{labelAttribute:"valueIron",attrId:303,dailyValue:18}];return function(a){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,u={full_nutrients:angular.copy(a.full_nutrients)};return u.itemName=(a.food_name||"").replace(/^([a-z])|\s+([a-z])/g,function(a){return a.toUpperCase()}),u.brandName=a.brand_name,u.valueServingUnitQuantity=a.serving_qty,u.valueServingSizeUnit=a.serving_unit,u.valueServingWeightGrams=a.serving_weight_grams/r,l.forEach(function(a){var t=e(u.full_nutrients,a.attrId);angular.isUndefined(t)?u[a.labelAttribute.replace("value","show")]=!1:(angular.isFunction(a.adapter)&&(t=a.adapter(t)),r&&1!==r&&(t/=r),a.dailyValue&&(t=100/a.dailyValue*t),u[a.labelAttribute]=t,u[a.labelAttribute.replace("value","show")]=!0)}),r&&1!==r&&angular.forEach(u.full_nutrients,function(a){a.value/=r}),angular.extend(u,i),angular.forEach(n,function(a,e){angular.isUndefined(u[e])&&angular.isUndefined(t[e])&&(u[e]=a)}),u}}])}();