"use strict";!function(){angular.module("nutritionix.nutrition-label",[]).constant("nutritionLabelGlobalOptions",{}).directive("nutritionLabel",["$log","nutritionLabelGlobalOptions",function(t,a){function e(t){if(!t)return t;var a=void 0;a=t<1?2:t<10?1:0;var e=Math.pow(10,a);return Math.round(t*e)/e}return{restrict:"A",template:'\n        <div>\n          <div class="label-container"></div>\n          <div class="label-mode-switch" ng-if="!hideModeSwitcher">\n            FDA Label Style:\n            <label class="radio-inline">\n              <input type="radio" name="labelMode" ng-value="false" ng-model="vm.showLegacyVersion"> 2018 Version\n            </label>\n            <label class="radio-inline">\n              <input type="radio" name="labelMode" ng-value="true" ng-model="vm.showLegacyVersion"> Legacy Version\n            </label>\n          </div>\n        </div>\n      ',scope:{item:"=nutritionLabel",options:"=?nutritionLabelOptions",hideModeSwitcher:"=?"},link:function(t,n,i){function l(){return JSON.stringify(u())}function u(){var e=angular.extend({},a,i,t.options||{},t.item,t.vm||{});return angular.forEach(e,function(t,a){"$"===a[0]?delete e[a]:-1===a.indexOf("userFunction")&&angular.isFunction(t)&&(e[a]=t())}),e}function r(){var a=void 0,n=void 0;if(o.html(""),angular.isObject(t.item)){if((a=angular.element("<div>").attr("id","label-"+Math.random().toString(36).substring(2))).appendTo(o),"function"==typeof(n=u()).userFunctionOnQuantityChange){var i=n.userFunctionOnQuantityChange;n.userFunctionOnQuantityChange=function(){i.apply(n,arguments),t.$apply()}}n.userFunctionOnQuantityChange&&angular.isUndefined(jQuery.fn.nutritionLabel.defaultSettings.userFunctionOnQuantityChange)&&(n.userFunctionOnQuantityChange.toString=function(){return"toString"},n.userFunctionNameOnQuantityChange=n.userFunctionOnQuantityChange),n.applyMathRounding&&["valueServingWeightGrams","valueServingPerContainer","valueCalories","valueFatCalories","valueTotalFat","valueSatFat","valueTransFat","valuePolyFat","valueMonoFat","valueCholesterol","valueSodium","valuePotassium","valuePotassium_2018","valueTotalCarb","valueFibers","valueSugars","valueAddedSugars","valueProteins","valueVitaminA","valueVitaminC","valueVitaminD","valueCalcium","valueIron"].forEach(function(t){angular.isUndefined(n[t])||(n[t]=e(n[t]))}),a.nutritionLabel(n)}}var o=n.find(".label-container"),d=u();t.vm={showLegacyVersion:!!angular.isUndefined(d.showLegacyVersion)||!!d.showLegacyVersion},t.$watch(l,function(t,a){t!==a&&r()}),r()}}}]).filter("trackFoodToLabelData",["$log","nutritionLabelGlobalOptions",function(t,a){function e(t,a){a=a.toString();for(var e=0;e<t.length;e+=1)if(t[e].attr_id.toString()===a)return t[e].value}var n={itemName:"Item",brandName:"Nutritionix",allowFDARounding:!1,applyMathRounding:!0,valueServingUnitQuantity:1,valueServingSizeUnit:"Serving"},i=[{labelAttribute:"valueCalories",attrId:208},{labelAttribute:"valueFatCalories",attrId:204,adapter:function(t){return 9*t}},{labelAttribute:"valueTotalFat",attrId:204},{labelAttribute:"valueSatFat",attrId:606},{labelAttribute:"valueTransFat",attrId:605},{labelAttribute:"valuePolyFat",attrId:645},{labelAttribute:"valueMonoFat",attrId:646},{labelAttribute:"valueCholesterol",attrId:601},{labelAttribute:"valueSodium",attrId:307},{labelAttribute:"valuePotassium",attrId:306},{labelAttribute:"valuePotassium_2018",attrId:306,dailyValue:3500},{labelAttribute:"valueTotalCarb",attrId:205},{labelAttribute:"valueFibers",attrId:291},{labelAttribute:"valueSugars",attrId:269},{labelAttribute:"valueProteins",attrId:203},{labelAttribute:"valueVitaminA",attrId:318,dailyValue:5e3},{labelAttribute:"valueVitaminC",attrId:401,dailyValue:60},{labelAttribute:"valueVitaminD",attrId:324,dailyValue:400},{labelAttribute:"valueCalcium",attrId:324,dailyValue:1e3},{labelAttribute:"valueIron",attrId:303,dailyValue:18}];return function(t){var l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r={full_nutrients:angular.copy(t.full_nutrients)};return r.itemName=(t.food_name||"").replace(/^([a-z])|\s+([a-z])/g,function(t){return t.toUpperCase()}),r.brandName=t.brand_name,r.valueServingUnitQuantity=t.serving_qty,r.valueServingSizeUnit=t.serving_unit,r.valueServingWeightGrams=t.serving_weight_grams/u,i.forEach(function(t){var a=e(r.full_nutrients,t.attrId);angular.isUndefined(a)?r[t.labelAttribute.replace("value","show")]=!1:(angular.isFunction(t.adapter)&&(a=t.adapter(a)),u&&1!==u&&(a/=u),t.dailyValue&&(a=100/t.dailyValue*a),r[t.labelAttribute]=a,r[t.labelAttribute.replace("value","show")]=!0)}),u&&1!==u&&angular.forEach(r.full_nutrients,function(t){t.value/=u}),angular.extend(r,l),angular.forEach(n,function(t,e){angular.isUndefined(r[e])&&angular.isUndefined(a[e])&&(r[e]=t)}),r}}])}();